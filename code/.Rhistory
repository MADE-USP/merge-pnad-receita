pdim(model_gmm_sys13)$nT$n,
pdim(model_gmm_sys14)$nT$n,
pdim(model_gmm_sys15)$nT$n)
}
{ # Sargan-Hansen overidentification test
j_p.value <- c("Hansen test of overidentification (p-value)",
round(summ_gmm_sys11$sargan$p.value,3),
round(summ_gmm_sys12$sargan$p.value,3),
round(summ_gmm_sys13$sargan$p.value,3),
round(summ_gmm_sys14$sargan$p.value,3),
round(summ_gmm_sys15$sargan$p.value,3))
}
{ # Arellano-Bond test for AR(2)
ab2_p.value <- c("Arellano-Bond test for AR(2) (p-value)",
round(summ_gmm_sys11$m2$p.value,3),
round(summ_gmm_sys12$m2$p.value,3),
round(summ_gmm_sys13$m2$p.value,3),
round(summ_gmm_sys14$m2$p.value,3),
round(summ_gmm_sys15$m2$p.value,3))
}
{ # lista de modelos
list <- list(model_gmm_sys11,model_gmm_sys12,model_gmm_sys13,model_gmm_sys14,
model_gmm_sys15)
}
{ # tabela
stargazer(list,
type = "text",
title = "GHG emission and inequality by states, GMM-Sys models",
dep.var.labels = "GHG emission (in tonnes)/GDP",
covariate.labels = c("GHG emission (in tonnes)/GDP, lagged",
"Top 10% appropriation",
"GDP per capita (thsd. Reais)",
"Deforestation (thsd. km2)",
"Agriculture/GDP",
"Energy/GDP"),
add.lines = list(time.fe,
obs,
id,
IV,
j_p.value,
ab2_p.value),
model.names = FALSE,
model.numbers = TRUE,
omit = "Constant",
omit.stat = c("N","f","rsq"),
out = "./results/table_gmm_sys_appropriation10_desmatamentototal.html")
}
}
### GMM-Sys (Gini index) -------------------------------------------------------
{
model_gmm_sys2 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini +
pib_pc + desmatamento_total + va_agro + energia_pib
| lag(emissao_pib,2:3) + lag(gini,3:3),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE
)
summary(model_gmm_sys2, robust = TRUE, time.dummies = T)
} # obs.: testes de sobreidentificação e correlação serial reportados
# Obter número de instrumentos
dim(model_gmm_sys2$W$`1`)[2]
# cálculo do etimador de longo prazo
## gini
nlConfint(model_gmm_sys2, "b[2]/(1-b[1])")
nlWaldtest(model_gmm_sys2, "b[2]/(1-b[1]) = 0")
# Testes de robustez GMM-Sys ---------------------------------------------------
{
int_emissao <- 2:3
int_desigualdade <- 3:3
model_gmm_sys21 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini
| lag(emissao_pib,int_emissao) + lag(gini,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys22 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini +
pib_pc
| lag(emissao_pib,int_emissao) + lag(gini,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys23 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini +
pib_pc + desmatamento_total
| lag(emissao_pib,int_emissao) + lag(gini,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys24 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini +
pib_pc + desmatamento_total + va_agro
| lag(emissao_pib,int_emissao) + lag(gini,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys25 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini +
pib_pc + desmatamento_total + va_agro + energia_pib
| lag(emissao_pib,int_emissao) + lag(gini,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
}
# Criar tabela comparativa
{
{ # dummies de tempo
time.fe <- c("Time fixed effects", "Yes", "Yes", "Yes", "Yes", "Yes")
}
{ # gerar summary dos modelos
summ_gmm_sys21 <- summary(model_gmm_sys21, robust = TRUE, time.dummies = T)
summ_gmm_sys22 <- summary(model_gmm_sys22, robust = TRUE, time.dummies = T)
summ_gmm_sys23 <- summary(model_gmm_sys23, robust = TRUE, time.dummies = T)
summ_gmm_sys24 <- summary(model_gmm_sys24, robust = TRUE, time.dummies = T)
summ_gmm_sys25 <- summary(model_gmm_sys25, robust = TRUE, time.dummies = T)
}
{ # instrumentos
IV <- c("Instruments",
dim(model_gmm_sys21$W$`1`)[2],
dim(model_gmm_sys22$W$`1`)[2],
dim(model_gmm_sys23$W$`1`)[2],
dim(model_gmm_sys24$W$`1`)[2],
dim(model_gmm_sys25$W$`1`)[2])
}
{ # número de observações
obs <- c("Observations",
pdim(model_gmm_sys21)$nT$N,
pdim(model_gmm_sys22)$nT$N,
pdim(model_gmm_sys23)$nT$N,
pdim(model_gmm_sys24)$nT$N,
pdim(model_gmm_sys25)$nT$N)
}
{ # número de grupos (estados)
id <- c("N. of states",
pdim(model_gmm_sys21)$nT$n,
pdim(model_gmm_sys22)$nT$n,
pdim(model_gmm_sys23)$nT$n,
pdim(model_gmm_sys24)$nT$n,
pdim(model_gmm_sys25)$nT$n)
}
{ # Sargan-Hansen overidentification test
j_p.value <- c("Hansen test of overidentification (p-value)",
round(summ_gmm_sys21$sargan$p.value,3),
round(summ_gmm_sys22$sargan$p.value,3),
round(summ_gmm_sys23$sargan$p.value,3),
round(summ_gmm_sys24$sargan$p.value,3),
round(summ_gmm_sys25$sargan$p.value,3))
}
{ # Arellano-Bond test for AR(2)
ab2_p.value <- c("Arellano-Bond test for AR(2) (p-value)",
round(summ_gmm_sys21$m2$p.value,3),
round(summ_gmm_sys22$m2$p.value,3),
round(summ_gmm_sys23$m2$p.value,3),
round(summ_gmm_sys24$m2$p.value,3),
round(summ_gmm_sys25$m2$p.value,3))
}
{ # lista de modelos
list <- list(model_gmm_sys21,model_gmm_sys22,model_gmm_sys23,model_gmm_sys24
,model_gmm_sys25)
}
{ # tabela
stargazer(list,
type = "text",
title = "GHG emission and inequality by states, GMM-Sys models",
dep.var.labels = "GHG emission (in tonnes)/GDP",
covariate.labels = c("GHG emission (in tonnes)/GDP, lagged",
"Gini index",
"GDP per capita (thsd. Reais)",
"Deforestation (thsd. km2)",
"Agriculture/GDP",
"Energy/GDP"),
add.lines = list(time.fe,
obs,
id,
IV,
j_p.value,
ab2_p.value),
model.names = FALSE,
model.numbers = TRUE,
omit = "Constant",
omit.stat = c("N","f","rsq"),
out = "./results/table_gmm_sys_gini_dematamentototal.html")
}
}
# Estimativas com dados da Receita ----------------------------------------
### GMM-Sys (Appropriation Top 10%) --------------------------------------------
{
model_gmm_sys1 <- pgmm(emissao_pib ~ lag(emissao_pib) + top10_receita +
pib_pc + desmatamento_total + va_agro + energia_pib
| lag(emissao_pib,2:3) + lag(top10_receita,2:3),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE
)
summary(model_gmm_sys1, robust = TRUE, time.dummies = T)
} # obs.: testes de sobreidentificação e correlação serial reportados
# Obter número de instrumentos
dim(model_gmm_sys1$W$`1`)[2]
# cálculo do etimador de longo prazo
## apropriacao_top10
nlConfint(model_gmm_sys1, "b[2]/(1-b[1])")
nlWaldtest(model_gmm_sys1, "b[2]/(1-b[1]) = 0")
# Testes de robustez GMM-Sys ---------------------------------------------------
{
int_emissao <- 2:3
int_desigualdade <- 2:3
model_gmm_sys11 <- pgmm(emissao_pib ~ lag(emissao_pib) + top10_receita
| lag(emissao_pib,int_emissao) + lag(top10_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys12 <- pgmm(emissao_pib ~ lag(emissao_pib) + top10_receita +
pib_pc
| lag(emissao_pib,int_emissao) + lag(top10_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys13 <- pgmm(emissao_pib ~ lag(emissao_pib) + top10_receita +
pib_pc + desmatamento_total
| lag(emissao_pib,int_emissao) + lag(top10_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys14 <- pgmm(emissao_pib ~ lag(emissao_pib) + top10_receita +
pib_pc + desmatamento_total + va_agro
| lag(emissao_pib,int_emissao) + lag(top10_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys15 <- pgmm(emissao_pib ~ lag(emissao_pib) + top10_receita +
pib_pc + desmatamento_total + va_agro + energia_pib
| lag(emissao_pib,int_emissao) + lag(top10_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
}
# Criar tabela comparativa
{
{ # dummies de tempo
time.fe <- c("Time fixed effects", "Yes", "Yes", "Yes", "Yes", "Yes")
}
{ # gerar summary dos modelos
summ_gmm_sys11 <- summary(model_gmm_sys11, robust = TRUE, time.dummies = T)
summ_gmm_sys12 <- summary(model_gmm_sys12, robust = TRUE, time.dummies = T)
summ_gmm_sys13 <- summary(model_gmm_sys13, robust = TRUE, time.dummies = T)
summ_gmm_sys14 <- summary(model_gmm_sys14, robust = TRUE, time.dummies = T)
summ_gmm_sys15 <- summary(model_gmm_sys15, robust = TRUE, time.dummies = T)
}
{ # instrumentos
IV <- c("Instruments",
dim(model_gmm_sys11$W$`1`)[2],
dim(model_gmm_sys12$W$`1`)[2],
dim(model_gmm_sys13$W$`1`)[2],
dim(model_gmm_sys14$W$`1`)[2],
dim(model_gmm_sys15$W$`1`)[2])
}
{ # número de observações
obs <- c("Observations",
pdim(model_gmm_sys11)$nT$N,
pdim(model_gmm_sys12)$nT$N,
pdim(model_gmm_sys13)$nT$N,
pdim(model_gmm_sys14)$nT$N,
pdim(model_gmm_sys15)$nT$N)
}
{ # número de grupos (estados)
id <- c("N. of states",
pdim(model_gmm_sys11)$nT$n,
pdim(model_gmm_sys12)$nT$n,
pdim(model_gmm_sys13)$nT$n,
pdim(model_gmm_sys14)$nT$n,
pdim(model_gmm_sys15)$nT$n)
}
{ # Sargan-Hansen overidentification test
j_p.value <- c("Hansen test of overidentification (p-value)",
round(summ_gmm_sys11$sargan$p.value,3),
round(summ_gmm_sys12$sargan$p.value,3),
round(summ_gmm_sys13$sargan$p.value,3),
round(summ_gmm_sys14$sargan$p.value,3),
round(summ_gmm_sys15$sargan$p.value,3))
}
{ # Arellano-Bond test for AR(2)
ab2_p.value <- c("Arellano-Bond test for AR(2) (p-value)",
round(summ_gmm_sys11$m2$p.value,3),
round(summ_gmm_sys12$m2$p.value,3),
round(summ_gmm_sys13$m2$p.value,3),
round(summ_gmm_sys14$m2$p.value,3),
round(summ_gmm_sys15$m2$p.value,3))
}
{ # lista de modelos
list <- list(model_gmm_sys11,model_gmm_sys12,model_gmm_sys13,model_gmm_sys14,
model_gmm_sys15)
}
{ # tabela
stargazer(list,
type = "text",
title = "GHG emission and inequality by states, GMM-Sys models",
dep.var.labels = "GHG emission (in tonnes)/GDP",
covariate.labels = c("GHG emission (in tonnes)/GDP, lagged",
"Top 10% appropriation",
"GDP per capita (thsd. Reais)",
"Deforestation (thsd. km2)",
"Agriculture/GDP",
"Energy/GDP"),
add.lines = list(time.fe,
obs,
id,
IV,
j_p.value,
ab2_p.value),
model.names = FALSE,
model.numbers = TRUE,
omit = "Constant",
omit.stat = c("N","f","rsq"),
out = "./results/table_receita_gmm_sys_appropriation10_desmatamentototal.html")
}
}
### GMM-Sys (Gini index) -------------------------------------------------------
{
model_gmm_sys2 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini_receita +
pib_pc + desmatamento_total + va_agro + energia_pib
| lag(emissao_pib,2:3) + lag(gini_receita,3:3),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE
)
summary(model_gmm_sys2, robust = TRUE, time.dummies = T)
} # obs.: testes de sobreidentificação e correlação serial reportados
# Obter número de instrumentos
dim(model_gmm_sys2$W$`1`)[2]
# cálculo do etimador de longo prazo
## gini
nlConfint(model_gmm_sys2, "b[2]/(1-b[1])")
nlWaldtest(model_gmm_sys2, "b[2]/(1-b[1]) = 0")
# Testes de robustez GMM-Sys ---------------------------------------------------
{
int_emissao <- 2:3
int_desigualdade <- 3:3
model_gmm_sys21 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini_receita
| lag(emissao_pib,int_emissao) + lag(gini_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys22 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini_receita +
pib_pc
| lag(emissao_pib,int_emissao) + lag(gini_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys23 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini_receita +
pib_pc + desmatamento_total
| lag(emissao_pib,int_emissao) + lag(gini_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys24 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini_receita +
pib_pc + desmatamento_total + va_agro
| lag(emissao_pib,int_emissao) + lag(gini,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
model_gmm_sys25 <- pgmm(emissao_pib ~ lag(emissao_pib) + gini_receita +
pib_pc + desmatamento_total + va_agro + energia_pib
| lag(emissao_pib,int_emissao) + lag(gini_receita,int_desigualdade),
data = dados,
index = c("id", "ano"),
model = "twosteps",
effect = "twoways",
transformation = "ld",
collapse = TRUE)
}
# Criar tabela comparativa
{
{ # dummies de tempo
time.fe <- c("Time fixed effects", "Yes", "Yes", "Yes", "Yes", "Yes")
}
{ # gerar summary dos modelos
summ_gmm_sys21 <- summary(model_gmm_sys21, robust = TRUE, time.dummies = T)
summ_gmm_sys22 <- summary(model_gmm_sys22, robust = TRUE, time.dummies = T)
summ_gmm_sys23 <- summary(model_gmm_sys23, robust = TRUE, time.dummies = T)
summ_gmm_sys24 <- summary(model_gmm_sys24, robust = TRUE, time.dummies = T)
summ_gmm_sys25 <- summary(model_gmm_sys25, robust = TRUE, time.dummies = T)
}
{ # instrumentos
IV <- c("Instruments",
dim(model_gmm_sys21$W$`1`)[2],
dim(model_gmm_sys22$W$`1`)[2],
dim(model_gmm_sys23$W$`1`)[2],
dim(model_gmm_sys24$W$`1`)[2],
dim(model_gmm_sys25$W$`1`)[2])
}
{ # número de observações
obs <- c("Observations",
pdim(model_gmm_sys21)$nT$N,
pdim(model_gmm_sys22)$nT$N,
pdim(model_gmm_sys23)$nT$N,
pdim(model_gmm_sys24)$nT$N,
pdim(model_gmm_sys25)$nT$N)
}
{ # número de grupos (estados)
id <- c("N. of states",
pdim(model_gmm_sys21)$nT$n,
pdim(model_gmm_sys22)$nT$n,
pdim(model_gmm_sys23)$nT$n,
pdim(model_gmm_sys24)$nT$n,
pdim(model_gmm_sys25)$nT$n)
}
{ # Sargan-Hansen overidentification test
j_p.value <- c("Hansen test of overidentification (p-value)",
round(summ_gmm_sys21$sargan$p.value,3),
round(summ_gmm_sys22$sargan$p.value,3),
round(summ_gmm_sys23$sargan$p.value,3),
round(summ_gmm_sys24$sargan$p.value,3),
round(summ_gmm_sys25$sargan$p.value,3))
}
{ # Arellano-Bond test for AR(2)
ab2_p.value <- c("Arellano-Bond test for AR(2) (p-value)",
round(summ_gmm_sys21$m2$p.value,3),
round(summ_gmm_sys22$m2$p.value,3),
round(summ_gmm_sys23$m2$p.value,3),
round(summ_gmm_sys24$m2$p.value,3),
round(summ_gmm_sys25$m2$p.value,3))
}
{ # lista de modelos
list <- list(model_gmm_sys21,model_gmm_sys22,model_gmm_sys23,model_gmm_sys24
,model_gmm_sys25)
}
{ # tabela
stargazer(list,
type = "text",
title = "GHG emission and inequality by states, GMM-Sys models",
dep.var.labels = "GHG emission (in tonnes)/GDP",
covariate.labels = c("GHG emission (in tonnes)/GDP, lagged",
"Gini index",
"GDP per capita (thsd. Reais)",
"Deforestation (thsd. km2)",
"Agriculture/GDP",
"Energy/GDP"),
add.lines = list(time.fe,
obs,
id,
IV,
j_p.value,
ab2_p.value),
model.names = FALSE,
model.numbers = TRUE,
omit = "Constant",
omit.stat = c("N","f","rsq"),
out = "./results/table_receita_gmm_sys_gini_dematamentototal.html")
}
}
gc()
help("read_excel")
t <- read_excel(paste0(dataDir, "TabelaOriginalReceita.xlsx", sheet = "BRV"))
library(tidyverse)
library(logger)
library(this.path)
library(hutils)
library(readxl)
setwd(this.dir())
dataDir <- '../raw/'
t <- read_excel(paste0(dataDir, "TabelaOriginalReceita.xlsx", sheet = "BRV"))
t <- read_excel(paste0(dataDir, "TabelaOriginalReceita.xlsx"))
View(t)
t <- read_excel(paste0(dataDir, "TabelaOriginalReceita.xlsx"), sheet = "BRV")
t
View(t)
